<!doctype html>
<html lang="en">


<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <?!= include('JavaScript'); ?>

  <title>Contact Details</title>

  <style>
  body {
    background-color: white; /* Light blue background */
    color: #333; /* Dark text color for good contrast */
    font-family: 'Tajawal', 'sans-serif'; /* Default font */
  }

  .form-container { /* Style the form container */
    background-color: #fff; /* White background for the form */
    border-radius: 5px;
    padding: 20px;
    margin: 0 auto; /* Center the form horizontally */
    max-width: 600px; /* Limit form width */
  }

  h3 {
    color: #FF0000; /* Match text color */
  }

  label {
    font-weight: bold; /* Bold labels for better readability */
  }

  .row {
    margin-bottom: 15px; /* Consistent spacing between rows */
  }

  .col-sm-3,
  .col-sm-9 {
    padding: 5px 0; /* Adjust padding for better layout */
  }

  select,
  input[type="text"],
  input[type="email"],
  input[type="tel"] {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 3px;
    box-sizing: border-box; /* Ensure padding doesn't affect width */
  }

  select {
    /* Style dropdowns */
    cursor: pointer;
  }

  .btn-primary {
    background-color: #337ab7; /* Blue button color */
    color: #fff; /* White button text */
    border-color: #2e6da4; /* Blue button border */
  }
</style>

</head>
<body >

  <script>
    function showLoading() {
      document.getElementById('loadingDiv').innerText = 'loading...';
    }

    window.onload = function() {
      //google.script.run.updateContacts();
      google.script.run.withSuccessHandler(populateDropdown).dropdownOptions_ScooleCode();
      google.script.run.withSuccessHandler(populateDropdown2).dropdownOptions_ScooleName();
      google.script.run.withSuccessHandler(populateDropdown3).getDropdownOptions();
    };

    function populateDropdown(options) {
      var dropdown = document.getElementById('codeDropdown');
      options.forEach(function(option) {
        var opt = document.createElement('option');
        opt.value = option;
        opt.innerHTML = option;
        dropdown.appendChild(opt);
      });
    }

    function populateDropdown2(options) {
      var dropdown = document.getElementById('nameDropdown');
      options.forEach(function(option) {
        var opt = document.createElement('option');
        opt.value = option;
        opt.innerHTML = option;
        dropdown.appendChild(opt);
      });
    }
         
    function populateDropdown3(options) {
        var dropdown = document.getElementById('entity_Name');
        options.forEach(function(option) {
          var opt = document.createElement('option');
          opt.value = option;
          opt.innerHTML = option;
          dropdown.appendChild(opt);
        });
    }

    function searchByCode() {
       var selectedValue = document.getElementById('codeDropdown').value;
       if(selectedValue){
        showLoading();
        google.script.run.withSuccessHandler(showSuccessMessage).insertNamebyCodeToContacts(selectedValue);
     }
     else{
       document.getElementById('loadingDiv').innerText = "Please choose a value before clicking Submit.";
     }
    }

    function searchByName() {
      var selectedValue = document.getElementById('nameDropdown').value;
       if (selectedValue){
        showLoading();  
        google.script.run.withSuccessHandler(showSuccessMessage).insertCodebyNameToContacts(selectedValue);
      }
      else{
        document.getElementById('loadingDiv').innerText = "Please choose a value before clicking Submit.";
      }
     }

     function showSuccessMessage() {  
        document.write("<center><h1>You have successfully Submited</h1></center>");
      }
      
    function insertEntity_Name() {
        var selectedValue = document.getElementById('entity_Name').value;
        google.script.run.addDataToSheet(selectedValue,4);
      }
      
    function insertjobtitle() {
        var selectedValue = document.getElementById('jobtitle').value;
        google.script.run.addDataToSheet(selectedValue,3);
      }

    function searchByCodeAdd() {
    var selectedValue = document.getElementById('codeDropdown').value;

     if (selectedValue){
     document.getElementById('s_Code').innerText = selectedValue;
      fetchData_byCode();
     }
     else{
       document.getElementById('loadingDiv').innerText = "Please choose a value before clicking Submit.";
     }  
     }

    function searchByNameAdd() {
    var selectedValue = document.getElementById('nameDropdown').value;
     if(selectedValue){
      document.getElementById('s_Name').innerText = selectedValue;
       fetchData_byName();
      }
     else{
       document.getElementById('loadingDiv').innerText = "Please choose a value before clicking Submit.";
     }
     }
    
    function checkAndSearch() {
         var sCodeValue = document.getElementById('s_Code').innerText;
         var sNameValue = document.getElementById('s_Name').innerText;

        if (sCodeValue) {
              searchByCode();
              google.script.run.getValueFromSheet(sCodeValue);
          } else if (sNameValue) {
              searchByName();
              google.script.run.getValueFromSheet(sCodeValue);
          } else if (sCodeValue =="" && sNameValue ==""){
              google.script.run.addDataToSheet("-",1)}
            else {
              console.log("No value found in either Code or Name.");
              }
        insertEntity_Name();
        insertjobtitle();
        }

</script>


  <script>
    function fetchData_byCode() {
      var selectedValue = document.getElementById('codeDropdown').value;
      google.script.run
        .withSuccessHandler(function(data) {
          // Handle the returned data from the server
          document.getElementById("nameDropdown").value = data;
        }).getNamebyCodeToContacts(selectedValue); // Call the server-side function
      }

  function fetchData_byName() {
      var selectedValue = document.getElementById('nameDropdown').value;
      google.script.run
        .withSuccessHandler(function(data) {
          // Handle the returned data from the server
          document.getElementById("codeDropdown").value = data;
        }).getCodebyNameToContacts(selectedValue); // Call the server-side function
    }
 </script>


<form id="myForm" onsubmit="handleFormSubmit(this)" action="" autocomplete="off">

<div class="row mb-3">
     <h3> You can choose either school code or name * </h3>
    <label for="codeDropdown" class="col-sm-3 col-form-label">School Code : </label>
    <div class="col-sm-9">
  <!-- <input type="text" id="searchInput" placeholder="Search...">
       <ul id="searchResults"></ul>-->


    <select id="codeDropdown" onchange ="searchByCodeAdd()">
       <option value="" disabled selected>Select a value</option>
    </select>
    <span id="s_Code" style="color: white;" ></span>
    </div>
  </div>


    <div class="row mb-3">
    <label for="nameDropdown" class="col-sm-3 col-form-label">School Name : </label>
    <div class="col-sm-9">
    <select id="nameDropdown" onchange="searchByNameAdd()">
      <option value="" disabled selected>Select a value</option>
    </select>
    <span id="s_Name" style="color: white;" ></span>
    </div>
  </div>
   
     <div id="loadingDiv" style="position: absolute; bottom: 80px; left: 50%; transform: translateX(-50%) font-size: 20px font-family: 'Tajawal', sans-serif;"></div>
   

    <!-- Dropdown Field: Category Dropdown  -->
 
  <div class="row mb-3">

    <h3> When you choose Entity Name don't Select (School Name, Code) * </h3>
    <label for="entity_Name" class="col-sm-3 col-form-label">Entity Name:</label>
    <div class="col-sm-9">
    <select
        id="entity_Name" >
        <option value="" disabled selected>Select a value</option>
   </select>
    </div>
  </div>


   <!-- Text Field: school code Field --> <!--
  <div class="row mb-3">
    <label for="schoolcode" class="col-sm-3 col-form-label">schoolcode:</label>
    <div class="col-sm-9">
      <input type="text" class="form-control" id="schoolcode" name="schoolcode" required>
    </div>
  </div>


-->

  <!-- Text Field: Frist Name Field -->
  <div class="row mb-3">
    <label for="Frist Name" class="col-sm-3 col-form-label">Frist Name:</label>
    <div class="col-sm-9">
      <input type="text" class="form-control" id="fName" name="fName" >
    </div>
  </div>


  <!-- Text Field: Last Name Field -->
  <div class="row mb-3">
    <label for="Last Name" class="col-sm-3 col-form-label">Last Name:</label>
    <div class="col-sm-9">
      <input type="text" class="form-control" id="lName" name="lName" >
    </div>
  </div>


  <!-- Text Field: Job title Field -->
  <div class="row mb-3">
    <label for="Job title" class="col-sm-3 col-form-label">Job title:</label>
    <div class="col-sm-9">
   <select id="jobtitle">
      <option value="" disabled selected>Select a value</option>
      <option value="Teacher">Teacher</option>
      <option value="Noor System Responsible">Noor System Responsible</option>
<option value="IT">IT</option>
<option value="Admin">Admin</option>
<option value="Academic Supervisor">Academic Supervisor</option>
<option value="Vice Principle">Vice Principle</option>
<option value="Principle">Principle</option>
<option value="Owner">Owner</option>
<option value="HR Manager">HR Manager</option>
<option value="Students Supervisor">Students Supervisor</option>
<option value="Logistical and administrative service">Logistical and administrative service</option>
<option value="Parents">Parents</option>
<option value="General Supervisor">General Supervisor</option>
<option value="Employee">Employee</option>
<option value="Customer Service">Customer Service</option>
<option value="HR">HR</option>
<option value="System Supervisor">System Supervisor</option>
<option value="Security guard">Security guard</option>
<option value="School Supervisor">School Supervisor</option>
<option value="Security & Safety officer">Security & Safety officer</option>
<option value="Canteen Manager">Canteen Manager</option>
<option value="General Manager">General Manager</option>
<option value="Director">Director</option>
<option value="Activity Leader">Activity Leader</option>
<option value="CEO">CEO</option>
<option value="School Transporation Supervisor">School Transporation Supervisor</option>
<option value="Receptionist">Receptionist</option>
<option value="Devlopment Supervisor">Devlopment Supervisor</option>
<option value="Student">Student</option>
<option value="Monitor">Monitor</option>
<option value="Data Entry">Data Entry</option>
<option value="Branches Manager">Branches Manager</option>
<option value="Branch Manager">Branch Manager</option>
<option value="IT Manager">IT Manager</option>
<option value="Level Manager">Level Manager</option>
<option value="CFO">CFO</option>
<option value="Contractor">Contractor</option>
<option value="Engineer">Engineer</option>
<option value="Electrical Engineer">Electrical Engineer</option>
<option value="Project Engineer">Project Engineer</option>
<option value="Site Engineer">Site Engineer</option>
<option value="Accountunt">Accountunt</option>
<option value="Parents Coordinator">Parents Coordinator</option>
<option value="Facilities Manager">Facilities Manager</option>
<option value="Financial Officer">Financial Officer</option>
<option value="Purchasing Supervisor">Purchasing Supervisor</option>
<option value="Specialist Purchases">Specialist Purchases</option>
<option value="Projects Manager">Projects Manager</option>
<option value="Double check">Double check</option>
<option value="School number">School number</option> 
    </select>
    </div>
  </div>


  <!-- Phone No Field:  -->
  <div class="row mb-3">
    <label for="phoneno" class="col-sm-3 col-form-label">Phone No:</label>
    <div class="col-sm-9">
      <input type="tel" class="form-control" id="phoneno" name="phoneno" placeholder="5XXXXXXXX" maxlength="9" >
    </div>
  </div>


  <!-- Phone No Field:  -->
  <div class="row mb-3">
    <label for="emailaddress1" class="col-sm-3 col-form-label">email address:</label>
    <div class="col-sm-9">
      <input type="email" class="form-control" id="emailaddress1" name="emailaddress1" >
    </div>
  </div>


  <!-- Submit Button -->
  <div class="row mb-3">
    <div class="col-sm-3"></div>
    <div class="col-sm-9 d-grid">
      <button type="submit" onclick= "checkAndSearch()" class="btn btn-primary">Submit</button>
    </div>
  </div>


 
</form>
 
</body>
</html>
